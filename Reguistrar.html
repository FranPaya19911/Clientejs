<!DOCTYPE html>
<html lang="es">

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="script.js"></script>
</head>

<body>
    <form action="#">
        <h1>Registrarse</h1>
        <div class="contenedor">
            <div>
                <label for="Nombre">NOMBRE </label>
                <input type="text" id="nombre">
            </div>
            <div>
                <label for="Apellidos">APELLIDOS </label>
                <input type="text" id="apellidos">
            </div>
            <div>
                <label for="email">EMAIL </label>
                <input type="text" id="email">
            </div>
            <div>
                <label for="password">CONTRASEÑA</label>
                <input type="password" id="pass1">
            </div>
            <div>
                <label for="password">REPETIR CONTRASEÑA</label>
                <input type="password" id="pass2">
            </div>
            <div>
                <label for="imagen">IMAGEN</label>


                <input id="file-upload" type="file" accept="image/*" />

                <div>
                    <img class="img" id="img" src="img/user.png">
                </div>

            </div>

        </div>
        <div class="p-contenedor">
            <input type="button" id="registrarse" value="Registrarse" onclick="validador()" />
        </div>
    </form>
    <div id="Errores"></div>
</body>
<script>
    //Este código tiene una parte esta sacado de internet y es para una
    //pequeña cosa que quería hacer y me parece que es lo mejor 
    //aunque tenga que Usar la API de Archivos de JavaScript
    // tengo claro de como funciona.
    var fileUpload = document.getElementById('file-upload');

    //Esto lo que hace es pasar el fileUpload.onchange a la función de 
    //de escucha por eso se puede observar que la función tiene un 
    //parámetro que se llama e que podría ser cualquiera otra letra como 
    // la a. Luego llamamos a una función leerArchivo y le pasamos e.srcElement
    //que lo que le pasa es de e el elemento src que es el input de arriba.
    fileUpload.onchange = function(e) {
        leerArchivo(e.srcElement);
    }


    //Input es el e.srcElemente de antes
    //con input.files lo que consigues es ver que es un archivo esto internamente
    //te saca la información del archivo que se ha seleccionado por parte del usuario
    //luego saco el tipo y si no es de tipo imagen pongo la de por defecto. 
    function leerArchivo(input) {
        debugger;
        if (input.files) {

            var tre = input.files;
            var texto = "";
            var i = 0;
            var f = tre[i];
            texto = f.type;
            var tipo = texto.substring(0, 5);

            if (tipo === "image") {
                //Creamos un nuevo objeto de fileReader
                //esto me permite leer el fichero.
                var reader = new FileReader();

                //Una vez entremos nos permite hacer otra función de escucha
                reader.onload = function(y) {
                    //Esto es para que solo pueda tener una imagen
                    document.getElementById('img').src = "";
                    var filePreview = document.getElementById('img');
                    //e.target.result contiene los datos base64 de la imagen cargada
                    filePreview.src = y.target.result;
                }

                //Esto nos proporciona el contenido especifico de la imagen
                //el input.files[0] es parecido al input.files, pero input.files[0]
                //solo dos devuelve datos relevantes para mostrar nuestra imagen.
                reader.readAsDataURL(input.files[0]);
            } else {
                document.getElementById('img').src = "img/user.png";
            }
        }
    }
</script>

</html>